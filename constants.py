import numpy as np

refractive_index_list = np.array([1.5308, 1.5296, 1.5283, 1.5274, 1.5263, 1.5253,
                                  1.5245, 1.5236, 1.5228, 1.5221, 1.5214, 1.5208,
                                  1.52015, 1.5196, 1.5190, 1.5185, 1.518, 1.5175,
                                  1.51707, 1.5167, 1.5163, 1.51585, 1.51545, 1.5151,
                                  1.5148, 1.51445, 1.51415, 1.51385, 1.5135, 1.51324,
                                  1.5131])

wave_length_list_400_700nm = np.array([400, 410, 420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550,
                                       560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690,
                                       700]) * 1e-9

wave_length_list_460_700nm = np.array([460, 470, 480, 490, 500, 510, 520, 530, 540, 550,
                                       560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690,
                                       700]) * 1e-9

wave_length_list_420_720nm = np.array([420, 430, 440, 450, 460, 470, 480, 490, 500, 510, 520, 530, 540, 550, 560, 570,
                                       580, 590, 600, 610, 620, 630, 640, 650, 660, 670, 680, 690, 700, 710,
                                       720]) * 1e-9

wave_length_list_430_670nm = np.array([430, 440, 450, 460, 470, 480, 490, 500, 510, 520,
                                       530, 540, 550, 560, 570, 580, 590, 600, 610, 620, 630, 640, 650, 660,
                                       670]) * 1e-9

SRF_E025_CL_BGR_31_CHANNEL_400_700NM = [
    [25.859, 33.025, 37.14, 40.388, 43.263, 45.42, 45.171, 44.5, 42.817, 36.504, 28.332, 21.426, 13.504, 9.44, 7.315,
     5.111, 3.094, 2.015
        , 1.873, 1.497, 1.28, 1.243, 1.222, 1.457, 1.928, 2.695, 3.343, 3.185, 2.14, 1.251, 0.562],
    [3.453, 3.389, 3.738, 4.177, 4.745, 6.345, 7.068, 8.539, 14.062, 21.481, 28.656, 34.97, 39.994, 43.164, 43.099,
     41.815, 38.84, 34.5
        , 28.453, 22.292, 15.025, 9.953, 7.694, 6.85, 6.553, 6.41, 6.768, 7.824, 9.157, 11.022, 12.893],
    [6.582, 4.762, 3.283, 2.682, 1.934, 1.495, 1.187, 0.992, 1.236, 1.431, 1.562, 1.789, 2.57, 3.107, 2.708, 2.612,
     2.767, 4.096, 17.122
        , 38.993, 43.694, 46.149, 45.743, 44.775, 44.311, 42.782, 40.492, 39.021, 35.628, 34.202, 34.054]
]

SRF_BFS_U3_88S6C_BGR_31_CHANNEL_400_700NM = [
    [0.384706393349006, 0.487273268437521, 0.542872134649849, 0.601055748955672, 0.667857974994079, 0.700258178507879,
     0.698917006827649, 0.624278907111156, 0.396972714567163, 0.194160102121156, 0.0359599712140295, 0, 0, 0, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 2.08707987241894e-05, 0.0113755574379251, 0.0400472303302546, 0.0596323734119197,
     0.0487409006616332, 0.0312722915976711, 0.0200712220579315, 0.0255705219177674],
    [0.00108195003927505, 1.75392243193272e-06, 6.36988302996532e-07, 0, 0, 0, 0, 0.0618554566587968, 0.398862284219680,
     0.662499724153517, 0.812239876100493, 0.865817689814593, 0.939031541539313, 0.959400934887969, 1,
     0.981732822845337, 0.968550776994897, 0.903402136634190, 0.738582274014943, 0.499982209749935, 0.316187861151251,
     0.161897141314716, 0.0495783770230754, 0.000189753894522987, 3.73619868637589e-06, 2.30797157225255e-06,
     2.35048683805720e-06, 3.83496895190998e-05, 0.0319967368325724, 0.0470463661753209, 0.0471694719291804],
    [0.0336192842552756, 0.00565698448379366, 1.01918128479445e-06, 6.30513199535322e-07, 2.27882382564546e-07, 0, 0, 0,
     0, 0, 0, 0, 0, 0, 0, 0, 0, 1.57029711403259e-07, 0.279812554958145, 0.700304183383708, 0.814490865408543,
     0.821032184549764, 0.822041935341495, 0.840140798667540, 0.801253494659279, 0.817034861218207, 0.788276241749138,
     0.577049332911038, 0.347736146499214, 0.183803417488018, 0.0894841112313052],
]

SRF_BFS_U3_GRAY_BGR_31_CHANNEL_400_700NM = [
    [1, 0.967161966007621, 0.946312907806522, 0.951125186227636, 0.967381755563482, 0.942072313550017,
     0.924674570401545, 0.905200726832384, 0.887533284795816, 0.880215907332776, 0.874817912598805, 0.853450971891996,
     0.848254710731795, 0.869085159396987, 0.846969692318927, 0.849549037253374, 0.837773107109923, 0.843994510860986,
     0.813666244621699, 0.834952536748230, 0.815945989206215, 0.797714461203120, 0.807305919998178, 0.780561412968636,
     0.781419625747506, 0.773116853575310, 0.756504054703138, 0.752891724116818, 0.740750034188051, 0.731174671123924,
     0.717323779987560],
    [1, 0.967161966007621, 0.946312907806522, 0.951125186227636, 0.967381755563482, 0.942072313550017,
     0.924674570401545, 0.905200726832384, 0.887533284795816, 0.880215907332776, 0.874817912598805, 0.853450971891996,
     0.848254710731795, 0.869085159396987, 0.846969692318927, 0.849549037253374, 0.837773107109923, 0.843994510860986,
     0.813666244621699, 0.834952536748230, 0.815945989206215, 0.797714461203120, 0.807305919998178, 0.780561412968636,
     0.781419625747506, 0.773116853575310, 0.756504054703138, 0.752891724116818, 0.740750034188051, 0.731174671123924,
     0.717323779987560],
    [1, 0.967161966007621, 0.946312907806522, 0.951125186227636, 0.967381755563482, 0.942072313550017,
     0.924674570401545, 0.905200726832384, 0.887533284795816, 0.880215907332776, 0.874817912598805, 0.853450971891996,
     0.848254710731795, 0.869085159396987, 0.846969692318927, 0.849549037253374, 0.837773107109923, 0.843994510860986,
     0.813666244621699, 0.834952536748230, 0.815945989206215, 0.797714461203120, 0.807305919998178, 0.780561412968636,
     0.781419625747506, 0.773116853575310, 0.756504054703138, 0.752891724116818, 0.740750034188051, 0.731174671123924,
     0.717323779987560]
]

SRF_BFS_U3_89S6M_GRAY_31_CHANNEL_400_700NM = [
    1, 0.967161966007621, 0.946312907806522, 0.951125186227636, 0.967381755563482, 0.942072313550017, 0.924674570401545,
    0.905200726832384, 0.887533284795816, 0.880215907332776, 0.874817912598805, 0.853450971891996, 0.848254710731795,
    0.869085159396987, 0.846969692318927, 0.849549037253374, 0.837773107109923, 0.843994510860986, 0.813666244621699,
    0.834952536748230, 0.815945989206215, 0.797714461203120, 0.807305919998178, 0.780561412968636, 0.781419625747506,
    0.773116853575310, 0.756504054703138, 0.752891724116818, 0.740750034188051, 0.731174671123924, 0.717323779987560
]

SRF_BFS_U3_88S6C_BGR_31_CHANNEL_430_670NM = [
    [0.416083542381229, 0.501298032485708, 0.576422130991911, 0.614752147037675, 0.618288662072261, 0.574225395931226,
     0.515061620165675, 0.425561944626529, 0.324197528225579, 0.233411222191555, 0.167174834287981, 0.122274212059680,
     0.0885362085379952, 0.0535374429203318, 0.0338824342132053, 0.0284507716842416, 0.0216826501983603,
     0.0176142257935475,
     0.0156991703675945, 0.0163771414511794, 0.0188990748682398, 0.0256904331577415, 0.0336330218889667,
     0.0426141301542272,
     0.0387265770675213],
    [0.0219217568816557, 0.0349824167819755, 0.0305369948305503, 0.0474808568850237, 0.188100882067360,
     0.408157640038519,
     0.685779755165712, 0.826024848696832, 0.870811121001986, 0.948120873219448, 0.988585789157625, 1,
     0.994443035829129, 0.943141146445958, 0.860599799021952, 0.779846388005321, 0.631199194836925, 0.495022449162350,
     0.325757785127586, 0.215649637906195, 0.192706858909299, 0.143895842209869, 0.126519655807711, 0.121176217147710,
     0.103412210052566],
    [0.0236411103625698, 0.0258869884186618, 0.0229754532534616, 0.0169931487799032, 0.0180661864132493,
     0.0206662096222035,
     0.0213195778807994, 0.0224348965865716, 0.0319739016049588, 0.0540885620655431, 0.0762061893770987,
     0.0507636620464377,
     0.0344996609451908, 0.0355902319413569, 0.0500169266956840, 0.264645857364738, 0.857573454720374,
     0.902087777290901,
     0.839905614666305, 0.800199569639905, 0.803900816656614, 0.722126698435829, 0.705189951104183, 0.686615851442096,
     0.488039673774274]
]

SRF_BFS_U3_88S6C_BGR_31_CHANNEL_460_700NM = [
    [46.65955711, 44.97380174, 42.26016774,
     35.50004653, 28.03846041, 20.29787608, 13.70564397, 9.722325144, 7.231906373, 4.967853628, 3.202065046,
     2.184233507, 1.836285129, 1.586892531, 1.358943904, 1.135153799, 1.227590476, 1.478570507, 1.995882243,
     2.721188174, 3.229119508, 3.179894938, 2.283567161, 1.348137444, 0.724738245],
    [4.85343158, 14.03512197, 33.39800734,
     47.62034583, 54.48847378, 57.59346551, 58.32896981, 59.49236532, 58.14619524, 56.9795439, 54.01251751, 51.14137543,
     46.72132402, 40.14084711, 31.86925929, 22.59998581, 16.07258693, 12.67019122, 10.94002049, 9.722541053,
     8.643719849, 8.110262677, 6.516759071, 4.425741173, 2.760398465],
    [1.318625695, 1.475911458, 1.635881235,
     1.54427472, 1.674356288, 2.498723416, 3.924646443, 4.700923391, 3.323684517, 2.241798618, 2.227311666, 5.092952135,
     23.88502721, 49.5733748, 56.31405836, 55.62174719, 54.09312688, 52.67057051, 51.95888314, 51.70757456, 45.98410239,
     37.76307594, 22.96991029, 11.93699506, 6.234105082]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_400_700NM = [
    [18.73589729, 28.27536788, 34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498],
    [6.425137553, 7.446242762, 8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275],
    [7.111793475, 5.795795295, 4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176]
]

SRF_GS3_U3_41S4C_BGR_31_CHANNEL_420_720NM = [
    [34.26532218, 38.89578098, 43.92060554, 48.2447291, 49.34113124, 48.42053339, 45.65638999,
     39.93330299, 32.29464007, 23.01558074, 15.2443332, 10.07552324, 7.201548122, 5.080157997, 3.264370381, 2.297836673,
     1.812185775, 1.52638278, 1.125983598, 0.806662059, 0.587345148, 0.537235367, 0.686925654, 1.03072496, 1.226171082,
     1.139780943, 0.623173653, 0.374706952, 0.244239498, 0.19618741, 0.19618741],
    [8.096116496, 8.900800174, 10.36405115, 12.03762611, 14.42202255, 19.65569408,
     25.23192339, 28.83286975, 33.85398281, 42.82070851, 53.13000898, 59.61325583, 61.75104661, 59.59523025,
     53.90891291, 47.30047763, 40.19970471, 32.09065727, 23.35397023, 15.10836029, 9.611802365, 6.887123842,
     5.589670348, 5.345366907, 4.950957308, 4.0502356, 2.583613336, 1.465660475, 0.684460275, 0.44380837, 0.34332796],
    [4.319709787, 3.166535783, 2.451689508, 2.011189415, 1.765684355, 2.010858585,
     2.201868624, 2.451063484, 2.659444915, 3.44220031, 5.054634739, 6.803908502, 6.245753758, 4.315452, 4.102605146,
     5.592691346, 16.81750851, 41.22101035, 54.5222667, 56.03542013, 53.9843276, 50.13648326, 48.50472486, 46.65697227,
     42.49659626, 29.31238995, 14.30632494, 5.929299276, 2.348298176, 0.83657815, 0.59286653]
]

SRF_MOCK_BGR_31_CHANNEL_400_700NM = [

    [0.005, 0.007, 0.012, 0.015, 0.023, 0.030, 0.026, 0.024, 0.019, 0.010, 0.004, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.002, 0.003, 0.005, 0.007, 0.012, 0.013, 0.015,
     0.016, 0.017, 0.020, 0.013, 0.011, 0.009, 0.005, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.002,
     0.002, 0.003],
    [0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001,
     0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.00000001, 0.001, 0.003, 0.010, 0.012,
     0.013, 0.022, 0.020, 0.020, 0.018, 0.017, 0.016, 0.016, 0.014, 0.014, 0.013]
]
SRF_BFS_U3_51S5PC_BGR_31_CHANNEL_400_700NM = [
    [8.9432, 11.6404, 13.3796, 15.2724, 16.6734, 17.7168, 17.7466, 17.1057, 16.2859, 13.8118, 11.5016, 8.938, 6.0466
        , 4.3624, 3.4532, 2.3652, 1.4411, 0.8897, 0.7704, 0.6512, 0.5021, 0.517, 0.4723, 0.6065, 0.7704, 1.1132, 1.456
        , 1.3815, 0.8897, 0.4276, 0.0997],
    [1.6207, 1.3368, 1.2066, 0.9819, 1.4196, 1.526, 1.7863, 4.9212, 10.7887, 16.9164, 20.2524, 22.5118, 22.7721,
     23.5528, 23.7658
        , 23.2216, 22.0741, 20.7492, 19.5544, 17.0702, 13.3557, 9.6885, 7.0741, 5.5718, 4.72, 4.033, 3.7145, 3.4898,
     2.3896, 1.3368, 0.4141],
    [1.9283, 1.4196, 1.1357, 0.9464, 0.7098, 0.5797, 0.4969, 0.556, 0.6152, 0.627, 0.6033, 1.0174, 1.5734, 1.9874,
     1.4077, 0.8872
        , 0.8163, 1.4432, 8.1743, 19.72, 22.2279, 22.1451, 22.3107, 22.0623, 21.1278, 21.2579, 19.9211, 16.8691
        , 9.3336, 4.4006, 0.8163]
]

SRF_BFS_U3_51S5PC_BGR_31_CHANNEL_460_700NM = [
    [17.7466, 17.1057, 16.2859, 13.8118, 11.5016, 8.938, 6.0466
        , 4.3624, 3.4532, 2.3652, 1.4411, 0.8897, 0.7704, 0.6512, 0.5021, 0.517, 0.4723, 0.6065, 0.7704, 1.1132, 1.456
        , 1.3815, 0.8897, 0.4276, 0.0997],
    [1.7863, 4.9212, 10.7887, 16.9164, 20.2524, 22.5118, 22.7721, 23.5528, 23.7658
        , 23.2216, 22.0741, 20.7492, 19.5544, 17.0702, 13.3557, 9.6885, 7.0741, 5.5718, 4.72, 4.033, 3.7145, 3.4898,
     2.3896, 1.3368, 0.4141],
    [0.4969, 0.556, 0.6152, 0.627, 0.6033, 1.0174, 1.5734, 1.9874, 1.4077, 0.8872
        , 0.8163, 1.4432, 8.1743, 19.72, 22.2279, 22.1451, 22.3107, 22.0623, 21.1278, 21.2579, 19.9211, 16.8691
        , 9.3336, 4.4006, 0.8163]
]

SRF_SAPPHIRE_S25A30CL_GRAY_31_CHANNEL_400_700NM = [
    39.52387622, 41.78260739, 43.71710988, 45.11623167, 46.30035537, 46.49899111, 47.17580019, 47.61406605, 47.51952076,
    48.72762724, 48.73404593, 50.70525556, 49.54251896, 50.26305817, 49.84265098, 49.42455289, 48.62886524, 49.06245476,
    48.07280128, 48.3340762, 48.62673229, 47.45452408, 47.00466159, 49.23973623, 46.00812168, 45.05571193, 45.26041172,
    43.49890985, 40.28837998, 41.36890754, 40.91668654
]

SRF_MV_CA013_20GC_BGR_31_CHANNEL_400_700NM = [
    [1199.9, 1772.7, 2101.9, 2392.7, 2710.9, 2908.4, 3051, 3122.4, 3084, 2678, 2244.5,
     1767.2, 1207.6, 807.1, 653.5, 499.9, 346.2, 291.4, 269.4, 258.5, 236.5,
     214.6, 209.1, 236.5, 285.9, 346.2, 428.5, 510.8, 571.2, 642.5, 624.8],
    [137.8, 220.1, 253, 264, 318.8, 390.1, 516.3, 691.9, 1141.8, 1690.4, 2299.4, 3111.4, 3736.8
        , 4060.5, 4181.2, 4104.4, 3874, 3435.1, 2864.5, 2321.4, 1641, 1032, 757.7, 669.9, 631.5
        , 653.5, 691.9, 829.1, 1075.9, 1328.3, 1591.7],
    [335.3, 285.9, 203.6, 121.3, 71.9, 50, 33.5, 39, 61, 44.5, 66.4, 115.8, 154.2, 203.6, 187.1, 192.6
        , 214.6, 357.2, 1898.9, 3989.2, 4680.5, 4878, 4910.9, 4746.3, 4669.5, 4609.2, 4433.6, 4362.3, 4161.4
        , 4051.6, 4086.6]
]


def refractive_index_noa61(wavelength, a=1.5375, b=0.00829045, c=-0.000211046):
    """ NOA61 dispersion formula
    https://refractiveindex.info/?shelf=other&book=Optical_adhesives&page=Norland_NOA61
    """
    return a + b / (wavelength * 1e6) ** 2 + c / (wavelength * 1e6) ** 4


def refractive_index_glass_bk7(wavelength):
    wavelength_square = (wavelength * 1e6) ** 2

    first = (1.03961212 * wavelength_square) / (wavelength_square - 0.00600069867)

    second = (0.231792344 * wavelength_square) / (wavelength_square - 0.0200179144)

    third = (1.01046945 * wavelength_square) / (wavelength_square - 103.560653)
    return ((first + second + third) + 1) ** 0.5


def refractive_index_glass_ohara_sk1300(wavelength):
    wavelength_square = (wavelength * 1e6) ** 2

    first = (7.44386780E-01 * wavelength_square) / (wavelength_square - 4.95119834E-03)

    second = (3.60198890E-01 * wavelength_square) / (wavelength_square - 1.41130274E-02)

    third = (9.18623119E-01 * wavelength_square) / (wavelength_square - 1.00428510E+02)
    return ((first + second + third) + 1) ** 0.5


def refractive_index_glass_az1500(wavelength):
    x = wavelength * 1e9
    index = 8.83727457272964e-12 * x ** 4 - 2.20202468762167e-08 * x ** 3 + 2.07114335635833e-05 * x ** 2 - 0.00882110372817165 * x + 3.05984593735538
    return index


MATERIAL_REFRACTIVE_INDEX_FUNCS = {
    "NOA61": refractive_index_noa61,
    "BK7": refractive_index_glass_bk7,
    "SK1300": refractive_index_glass_ohara_sk1300,
    "AZ1500": refractive_index_glass_az1500
}
